/*!
 * @preserve
 * jquery.scrolldepth.js | v1.0
 * Copyright (c) 2016 Rob Flaherty (@robflaherty)
 * Licensed under the MIT and GPL licenses.
 */
function setShareBtns(){if($(".btn_fb").click(function(){var n=$(this).attr("data-href");return n+=n.indexOf("?")===-1?"?":"&",n=n+"utm_source=site.facebook&utm_medium=share&utm_campaign=fbuser",FB.ui({method:"share",href:n},function(){}),ga("send","event","button-ui","share","FB分享"),!1}),$(".btn_line").click(function(){var t=$(this).attr("data-title").replace(" | ","｜"),n=$(this).attr("data-href");return n+=n.indexOf("?")===-1?"?":"&",n+="utm_source=LINE&utm_medium=share&utm_campaign=lineuser",shortenUrl(n,function(t){n=t}),window.location.href="http://line.me/R/msg/text/?"+encodeURIComponent(t)+"%0D%0A"+n,ga("send","event","button-ui","share","Line分享"),!1}),$(".btn_copy").length){var n=new ClipboardJS(".btn_copy");$(".btn_copy").click(function(){var n=new ClipboardJS(".btn_copy")})}}function shortenUrl(n,t){$.ajax({url:"https://api-ssl.bitly.com/v4/shorten",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer 4ad3b281a1e3c2ae3397c94bd21e6eba95fc25cc"},async:!1,data:JSON.stringify({long_url:n,group_guid:"Bi5i9LDGWOt"}),success:function(n){t(n.link)},error:function(){t(n)}})}function determineOverflow(n,t){var i=t.getBoundingClientRect(),r=Math.floor(i.right),u=Math.floor(i.left),f=n.getBoundingClientRect(),e=Math.floor(f.right),o=Math.floor(f.left);return u>o&&r<e?"both":o<u?"left":e>r?"right":"none"}function setDFP(){var n=$(".jsADslot:not([js_render])").filter(":visible"),t=[];console.log("dfpslots.length="+n.length);n=n.not("[data-isinitview='Y']");n=n.not("[id='div-gpt-ad-focus']");n=n.not("[data-dfp='cna2018_all_home_1x1_3']").not("[data-dfp='cna2018_all_home_1x1_6']").not("[data-dfp='cna2018_all_home_1x1_9']");n=n.not("[data-dfp='cna2018_all_pc_970x90_popup']");n.length&&(loadGPT(),googletag.cmd.push(function(){$(n).each(function(n){var i=$(this);console.log("defineSlot_jsADslot : dfp ="+i.attr("data-dfp")+" id="+i.attr("id")+" js_render="+i.attr("js_render"));i.attr("js_render","true");switch(i.attr("data-dfp")){case"cna2018_all_pc_970x250_M":t[n]=googletag.defineSlot("/137033094/"+i.attr("data-dfp"),[[970,250],[970,90]],i.attr("id")).addService(googletag.pubads()).setCollapseEmptyDiv(!0,!0);break;default:t[n]=googletag.defineSlot("/137033094/"+i.attr("data-dfp"),[parseInt(i.attr("data-width")),parseInt(i.attr("data-height"))],i.attr("id")).addService(googletag.pubads())}});googletag.pubads().disableInitialLoad();googletag.enableServices();googletag.pubads().addEventListener("slotRenderEnded",function(){});$(n).each(function(){googletag.display($(this).attr("id"))});$(t).each(function(n){googletag.pubads().refresh([t[n]])})}))}function setPrivacyLanguage(){var i=getCookie("CnaClosePrivacy"),n=getCookie("CnaCloseLanguage"),t;n==null&&(showLanguageBar()||(setCookie("CnaCloseLanguage",1,5256e3,""),n=1));i==null&&n==null?($("body").addClass("bar-both-open"),$(".privacy-bar").addClass("need"),$(".language-bar").addClass("need")):i==null?($("body").addClass("GDPR-open"),$(".privacy-bar").addClass("need")):n==null&&($("body").addClass("language-open"),$(".language-bar").addClass("need"));t=5256e3;$(".close-privacy").click(function(){var n=$("body");$(this).parent().removeClass("need");setCookie("CnaClosePrivacy",1,t,"")});$(".close-language").click(function(){var n=$("body");$(this).parent().removeClass("need");setCookie("CnaCloseLanguage",1,t,"")})}function showLanguageBar(){var i=!1,r=["en","ja","es"],n=(navigator.language||navigator.browserLanguage).toLowerCase(),t;for(n=n.substring(0,2),$("#language-bar-en").hide(),$("#language-bar-ja").hide(),$("#language-bar-es").hide(),t=0;t<r.length;t++)if(r[t].toLowerCase().indexOf(n)!=-1){i=!0;switch(n){case"en":$("#language-bar-en").show();break;case"ja":$("#language-bar-ja").show();break;case"es":$("#language-bar-es").show()}break}return i}function setIdle(){var n,t;if(window.innerWidth>1024){var i=function(){t();$(".overlayidle").addClass("showidle")},r=function(){},u=function(){},f=function(){},e=new Idle({onHidden:f,onVisible:u,onAway:i,onAwayBack:r,awayTimeout:18e4}).start();$(document).mouseup(function(n){var t=$(".idleGroup");t.is(n.target)||t.has(n.target).length!==0||$(".overlayidle").removeClass("showidle")});$(".overlayidle .closeBtn").click(function(){".overlayidle".removeClass("showidle")});n="undefined";googletag.cmd.push(function(){n=googletag.defineSlot("/137033094/cna2018_all_pc_970x90_popup",[970,90],"div-gpt-ad-idle").addService(googletag.pubads());googletag.pubads().disableInitialLoad();googletag.pubads().collapseEmptyDivs();googletag.enableServices()});googletag.cmd.push(function(){googletag.display("div-gpt-ad-idle")});t=function(){googletag.cmd.push(function(){googletag.pubads().refresh([n])})}}}var pnProductNav,pnProductNavContents,ScrollFix;(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):typeof module=="object"&&module.exports?module.exports=n(require("jquery")):n(jQuery)})(function(n){"use strict";var h={minHeight:0,elements:[],percentage:!0,userTiming:!0,pixelDepth:!0,nonInteraction:!0,gaGlobal:!1,gtmOverride:!1,trackerName:!1,dataLayer:"dataLayer"},f=n(window),t=[],o=!1,i=0,e,s,r,u;return n.scrollDepth=function(c){function v(n,t,f,o){var h=c.trackerName?c.trackerName+".send":"send";u?(u({event:"ScrollDistance",eventCategory:"Scroll Depth",eventAction:n,eventLabel:t,eventValue:1,eventNonInteraction:c.nonInteraction}),c.pixelDepth&&arguments.length>2&&f>i&&(i=f,u({event:"ScrollDistance",eventCategory:"Scroll Depth",eventAction:"Pixel Depth",eventLabel:l(f),eventValue:1,eventNonInteraction:c.nonInteraction})),c.userTiming&&arguments.length>3&&u({event:"ScrollTiming",eventCategory:"Scroll Depth",eventAction:n,eventLabel:t,eventTiming:o})):(e&&(window[r](h,"event","Scroll Depth",n,t,1,{nonInteraction:c.nonInteraction}),c.pixelDepth&&arguments.length>2&&f>i&&(i=f,window[r](h,"event","Scroll Depth","Pixel Depth",l(f),1,{nonInteraction:c.nonInteraction})),c.userTiming&&arguments.length>3&&window[r](h,"timing","Scroll Depth",n,o,t)),s&&(_gaq.push(["_trackEvent","Scroll Depth",n,t,1,c.nonInteraction]),c.pixelDepth&&arguments.length>2&&f>i&&(i=f,_gaq.push(["_trackEvent","Scroll Depth","Pixel Depth",l(f),1,c.nonInteraction])),c.userTiming&&arguments.length>3&&_gaq.push(["_trackTiming","Scroll Depth",n,o,t,100])))}function p(n){return{"25%":parseInt(n*.25,10),"50%":parseInt(n*.5,10),"75%":parseInt(n*.75,10),"100%":n-5}}function w(i,r,u){n.each(i,function(i,f){n.inArray(i,t)===-1&&r>=f&&(v("Percentage",i,r,u),t.push(i))})}function b(i,r,u){n.each(i,function(i,f){n.inArray(f,t)===-1&&n(f).length&&r>=n(f).offset().top&&(v("Elements",f,r,u),t.push(f))})}function l(n){return(Math.floor(n/250)*250).toString()}function k(){a()}function d(n,t){var u,f,e,i=null,r=0,o=function(){r=new Date;i=null;e=n.apply(u,f)};return function(){var s=new Date,h;return r||(r=s),h=t-(s-r),u=this,f=arguments,h<=0?(clearTimeout(i),i=null,r=s,e=n.apply(u,f)):i||(i=setTimeout(o,h)),e}}function a(){o=!0;f.on("scroll.scrollDepth",d(function(){var u=n(document).height(),e=window.innerHeight?window.innerHeight:f.height(),i=f.scrollTop()+e,s=p(u),r=+new Date-y;if(t.length>=c.elements.length+(c.percentage?4:0)){f.off("scroll.scrollDepth");o=!1;return}c.elements&&b(c.elements,i,r);c.percentage&&w(s,i,r)},500))}var y=+new Date;(c=n.extend({},h,c),n(document).height()<c.minHeight)||(c.gaGlobal?(e=!0,r=c.gaGlobal):typeof ga=="function"?(e=!0,r="ga"):typeof __gaTracker=="function"&&(e=!0,r="__gaTracker"),typeof _gaq!="undefined"&&typeof _gaq.push=="function"&&(s=!0),typeof c.eventHandler=="function"?u=c.eventHandler:typeof window[c.dataLayer]=="undefined"||typeof window[c.dataLayer].push!="function"||c.gtmOverride||(u=function(n){window[c.dataLayer].push(n)}),n.scrollDepth.reset=function(){t=[];i=0;f.off("scroll.scrollDepth");a()},n.scrollDepth.addElements=function(t){typeof t!="undefined"&&n.isArray(t)&&(n.merge(c.elements,t),o||a())},n.scrollDepth.removeElements=function(i){typeof i!="undefined"&&n.isArray(i)&&n.each(i,function(i,r){var u=n.inArray(r,c.elements),f=n.inArray(r,t);u!=-1&&c.elements.splice(u,1);f!=-1&&t.splice(f,1)})},k())},n.scrollDepth}),function(){var n;document.addEventListener||(document.addEventListener=document.attachEvent?function(n,t,i){return document.attachEvent("on"+n,t,i)}:function(){return{}});document.removeEventListener||(document.removeEventListener=document.detachEvent?function(n,t){return document.detachEvent("on"+n,t)}:function(){return{}});n={};n=function(){function n(n){var t,i;n&&(this.awayTimeout=parseInt(n.awayTimeout,10),this.onAway=n.onAway,this.onAwayBack=n.onAwayBack,this.onVisible=n.onVisible,this.onHidden=n.onHidden);i=this;t=function(){return i.onActive()};window.addEventListener("click",t);window.addEventListener("mousemove",t);window.addEventListener("mouseenter",t);window.addEventListener("keydown",t);window.addEventListener("scroll",t);window.addEventListener("mousewheel",t);window.addEventListener("touchmove",t);window.addEventListener("touchstart",t)}return n.isAway=!1,n.awayTimeout=3e3,n.awayTimestamp=0,n.awayTimer=null,n.onAway=null,n.onAwayBack=null,n.onVisible=null,n.onHidden=null,n.prototype.onActive=function(){return this.awayTimestamp=(new Date).getTime()+this.awayTimeout,this.isAway&&(this.onAwayBack&&this.onAwayBack(),this.start()),this.isAway=!1,!0},n.prototype.start=function(){var n;return this.listener||(this.listener=function(){return n.handleVisibilityChange()},document.addEventListener("visibilitychange",this.listener,!1),document.addEventListener("webkitvisibilitychange",this.listener,!1),document.addEventListener("msvisibilitychange",this.listener,!1)),this.awayTimestamp=(new Date).getTime()+this.awayTimeout,this.awayTimer!==null&&clearTimeout(this.awayTimer),n=this,this.awayTimer=setTimeout(function(){return n.checkAway()},this.awayTimeout+100),this},n.prototype.stop=function(){return this.awayTimer!==null&&clearTimeout(this.awayTimer),this.listener!==null&&(document.removeEventListener("visibilitychange",this.listener),document.removeEventListener("webkitvisibilitychange",this.listener),document.removeEventListener("msvisibilitychange",this.listener),this.listener=null),this},n.prototype.setAwayTimeout=function(n){return this.awayTimeout=parseInt(n,10),this},n.prototype.checkAway=function(){var t,n;if(n=(new Date).getTime(),n<this.awayTimestamp){this.isAway=!1;t=this;this.awayTimer=setTimeout(function(){return t.checkAway()},this.awayTimestamp-n+100);return}return this.awayTimer!==null&&clearTimeout(this.awayTimer),this.isAway=!0,this.onAway?this.onAway():void 0},n.prototype.handleVisibilityChange=function(){if(document.hidden||document.msHidden||document.webkitHidden){if(this.onHidden)return this.onHidden()}else if(this.onVisible)return this.onVisible()},n}();typeof define=="function"&&define.amd?define([],n):typeof exports=="object"?module.exports=n:window.Idle=n}.call(this);$(function(){setShareBtns()});document.documentElement.classList.remove("no-js");document.documentElement.classList.add("js");document.getElementById("pnProductNav")&&document.getElementById("pnProductNavContents")&&(pnProductNav=document.getElementById("pnProductNav"),pnProductNavContents=document.getElementById("pnProductNavContents"),pnProductNav.setAttribute("data-overflowing",determineOverflow(pnProductNavContents,pnProductNav)));$(function(){window.fbAsyncInit=function(){FB.init({appId:"524202197752727",xfbml:!0,version:"v3.1"});FB.AppEvents.logPageView()},function(n){var t,i="facebook-jssdk",r=n.getElementsByTagName("script")[0];n.getElementById(i)||(t=n.createElement("script"),t.id=i,t.async=!0,t.src="https://connect.facebook.net/zh_TW/sdk.js",r.parentNode.insertBefore(t,r))}(document);$(".btn_fb_all").click(function(){ga("send","event","button-ui","share","FB分享");FB.ui({method:"share",href:"https://www.cna.com.tw/"},function(){})});$(".btn_line_all").click(function(){return ga("send","event","button-ui","share","Line分享"),shareLineWithShortUrl("CNA 中央社","https://www.cna.com.tw"),!1})});ScrollFix=function(n){var i,t;(n=n||document.querySelector(n),n)&&n.addEventListener("touchstart",function(r){i=r.touches[0].pageY;t=n.scrollTop;t<=0&&(n.scrollTop=1);t+n.offsetHeight>=n.scrollHeight&&(n.scrollTop=n.scrollHeight-n.offsetHeight-1)},!1)};!function(n,t,i,r,u,f,e){n.fbq||(u=n.fbq=function(){u.callMethod?u.callMethod.apply(u,arguments):u.queue.push(arguments)},n._fbq||(n._fbq=u),u.push=u,u.loaded=!0,u.version="2.0",u.queue=[],f=t.createElement(i),f.async=!0,f.src=r,e=t.getElementsByTagName(i)[0],e.parentNode.insertBefore(f,e))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","1056893641102242");fbq("set","agent","tmgoogletagmanager","1056893641102242");fbq("track","PageView");jQuery(function(){jQuery.scrollDepth()});setDFP();loadJsCssFile(STATIC_DOC_PATH+"/bundle_css/site_footer.min.css?v="+STATIC_DOC_VER,"css",null);setIdle();setPrivacyLanguage();